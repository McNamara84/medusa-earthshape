<table class="table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>name</th>
      <th>box-type</th>
      <th></th>
 <% if @current_user.advanced then %>  
      <th>global-id</th>
 <% end %>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <%= form_tag bundle_edit_boxes_path, id: "box-bundle-form" do %>
      <% @box.children.each do |box| %>
        <tr>
          <td>
            <%= check_box_tag("ids[]", box.id, false, {id: "ids_#{box.id}", class: "select-row"}) if can?(:update, box) %>
          </td>
          <td><%= link_to_if can?(:read, box), box.name,box %></td>
          <td><%= box.box_type.try!(:name) %></td>
          <td></td>
 <% if @current_user.advanced then %>  
	<td><%= box.try!(:global_id) %></td> 
<% end %>
          <td>
            <%= link_to box_box_path(@box,box), method: :delete ,title: "unlink box",data: {confirm: t("confirm.unlink")} do %>
              <%= bi_icon('remove') %>
            <% end %>
          </td>
        </tr>
      <% end %>
    <% end %>
  </tbody>
  <tfoot>
    <tr>

        <th><%= check_box_tag nil, nil, false, class: "select-row-all" %></th><th>Select all</th>
	

    </tr>
  </tfoot>
</table>
<%= link_to "bundle edit", "#", onclick: "$('#box-bundle-form').submit();; return false;", class: "btn btn-secondary btn-sm" %>
 <hr style="clear:both">   
  <div style="clear:both">Enter Child to this Storageroom/Box </div>
<div>
      <%= form_for Box.new, url: box_boxes_path(@box) do |f|%>
        <%= hidden_tabname_tag(__FILE__) %>	
		<div style="float:left; margin:10px">
		   <div class="mb-3 mb-3-sm">
		    <%= f.label :name, class: "small" %>
		    <%= f.text_field :name, class: "form-control input-sm", placeholder: "- required -" %>
		  </div>
		</div>
		<div style="float:left; margin:10px">   
			  <div class="mb-3 mb-3-sm">
			    <%= f.label :box_type_id, class: "small" %>
				    <div class="input-group">
				      <%= f.select :box_type_id, BoxType.order(:name).pluck(:name, :id), { :prompt =>  '- please select -'  }, class: "form-control input-sm" %>         
				    </div>
			   </div>
		 </div>
		<div style="float:left; margin:10px">   
				  <div class="mb-3 mb-3-sm">
					  <%= f.fields_for :record_property_attributes do |r| %>
						  <label class="small">Group</label>
						  <div >
								    <%= r.select :group_id ,@current_user.groups.order(:name).pluck(:name, :id), { include_blank: true }, class: "form-control input-sm" %>
								    <%= r.hidden_field :user_id ,value: @current_user.id %>
		    			                            <%= r.hidden_field :guest_readable , value: "true" %>
						  </div>
					  <% end %>
				</div>
			</div>	
	
			 <div style="float:left; margin:10px">

				  <div class="mb-3 mb-3-sm">
					  <label class="small">Save</label>
					  <div>
					    <%= f.button class: "btn btn-secondary btn-sm" do %>
					    <%= bi_icon('save') %>
					    <% end %>
					  </div>
				</div>
				
			</div> 
      <% end %>
</div>
 <hr style="clear:both">   

 <div style="clear:both">Link Storageroom/Box </div>
<div>
      <%= form_tag link_by_global_id_box_boxes_path(@box), method: :post do %>
        <%= hidden_tabname_tag(__FILE__) %>
			 <div style="float:left; margin:10px">
	  <div class="input-group">
            <%= select_tag :global_id, options_for_select(Box.choose_global_id(@current_user)), { include_blank: true  , id: "child-global-id", class: "form-control input-sm"} %>	  

	    <span class="input-group-text">
	      <%= link_to boxes_path(per_page: 10, format: :modal), "data-toggle" => "modal", "data-target" => "#search-modal", "data-input" => "#child-global-id" do %>
	      <%= bi_icon('search') %>
	      <% end %>
	    </span>
	  </div>
	  </div>
			 <div style="float:left; margin:10px">	  
          <%= button_tag title: "link box by global id", class: "btn btn-secondary btn-sm" do %>
            <%= bi_icon('save') %>
          <% end %>
	  </div>
      <% end %>
      </div>


